CREATE TABLE yahoo_finance (
    date DATE PRIMARY KEY,
    open DECIMAL(10, 2),
    high DECIMAL(10, 2),
    low DECIMAL(10, 2),
    close DECIMAL(10, 2),
    adj_close DECIMAL(10, 2),
    volume BIGINT
);
INSERT INTO yahoo_finance (date, open, high, low, close, adj_close, volume) VALUES
('2021-04-28', 33797.43, 34104.56, 33728.40, 34098.16, 34098.16, 3543100000),
('2021-04-27', 33381.66, 33859.75, 33374.65, 33826.16, 33826.16, 3432400000),
('2021-04-26', 33596.34, 33645.83, 33235.85, 33301.87, 33301.87, 3211700000),
('2021-04-25', 33828.34, 33875.49, 33525.39, 33530.83, 33530.83, 2978800000),
('2021-04-24', 33805.04, 33891.15, 33726.09, 33875.40, 33875.40, 2520200000),
('2021-04-21', 33793.60, 33858.83, 33688.57, 33808.96, 33808.96, 2910800000),
('2021-04-20', 33740.60, 33875.39, 33677.74, 33786.62, 33786.62, 3079100000),
('2021-04-19', 33889.83, 33957.98, 33814.65, 33897.01, 33897.01, 2514900000),
('2021-04-18', 33965.16, 34018.62, 33791.89, 33976.63, 33976.63, 2535700000),
('2021-04-17', 33930.46, 33991.23, 33796.91, 33987.18, 33987.18, 2345300000),
('2021-04-14', 33981.71, 34082.94, 33730.85, 33886.47, 33886.47, 2767200000),
('2021-04-13', 33668.97, 34054.99, 33605.17, 34029.69, 34029.69, 2772300000),
('2021-04-12', 33764.21, 33895.43, 33593.32, 33646.50, 33646.50, 2603000000),
('2021-04-11', 33586.75, 33781.29, 33586.75, 33684.79, 33684.79, 2414300000),
('2021-04-10', 33425.25, 33590.24, 33343.43, 33586.52, 33586.52, 2329200000),
('2021-04-06', 33420.96, 33525.96, 33325.37, 33485.29, 33485.29, 2586800000),
('2021-04-05', 33394.60, 33543.84, 33376.27, 33482.72, 33482.72, 2866600000),
('2021-04-04', 33594.79, 33634.72, 33275.62, 33402.38, 33402.38, 2833600000),
('2021-04-03', 33245.78, 33632.90, 32901.96, 33274.15, 33274.15, 3118900000),
('2021-03-31', 32807.43, 32905.80, 32682.87, 32859.03, 32859.03, 3537400000),
('2021-03-30', 32566.54, 32728.04, 32539.94, 32717.60, 32717.60, 2833800000),
('2021-03-29', 32434.85, 32551.01, 32295.50, 32394.25, 32394.25, 3141100000),
('2021-03-28', 32276.72, 32564.00, 32276.72, 32432.08, 32432.08, 2485600000),
('2021-03-27', 32038.22, 32257.24, 31805.18, 32237.53, 32237.53, 3170700000),
('2021-03-24', 32101.49, 32511.49, 31864.74, 32105.25, 32105.25, 3354300000),
('2021-03-23', 32570.19, 32761.89, 32020.46, 32030.11, 32030.11, 3259900000),
('2021-03-22', 32420.71, 32593.68, 32346.12, 32560.60, 32560.60, 3631900000),
('2021-03-21', 31872.33, 32280.07, 31872.33, 32244.58, 32244.58, 3572100000);
SELECT
    MIN(open) AS min_open,
    MAX(open) AS max_open,
    AVG(open) AS avg_open,
    MIN(high) AS min_high,
    MAX(high) AS max_high,
    AVG(high) AS avg_high,
    MIN(low) AS min_low,
    MAX(low) AS max_low,
    AVG(low) AS avg_low,
    MIN(close) AS min_close,
    MAX(close) AS max_close,
    AVG(close) AS avg_close
FROM yahoo_finance;
SELECT
    DATE_FORMAT(date, '%Y-%m') AS month,
    AVG(close) AS avg_close
FROM yahoo_finance
GROUP BY month
ORDER BY month;
SELECT
    YEAR(date) AS year,
    (MAX(close) - MIN(close)) / MIN(close) * 100 AS annual_return
FROM yahoo_finance
GROUP BY year
ORDER BY year;
SELECT
    YEAR(date) AS year,
    MAX(close) AS highest_close,
    MIN(close) AS lowest_close
FROM yahoo_finance
GROUP BY year
ORDER BY year;
SELECT
    DATE_FORMAT(date, '%Y-%m') AS month,
    AVG(volume) AS avg_volume
FROM yahoo_finance
GROUP BY month
ORDER BY month;

